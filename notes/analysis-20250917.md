# 2025-09-17 C2-Graph 試作結果メモ

## 実行概要
- スクリプト: `scripts/prototype/c2_graph_baseline.py`, `scripts/prototype/c2_batch_report.py`
- データ: `data/sample/meeting-sample-001.json`, `data/sample/meeting-sample-002.json`
- 出力: `runs/20250917-c2-proto/report.md`, `runs/20250917-c2-proto/batch_report.md`

## 主な観察
1. **権限外CANCEL検出**
   - sample-001 の turn10 (Bob→C2), turn13 (Dave→C3) を `unauthorized_cancel` として検出。
   - REVISE後にオーナーがAliceへ移ったC3では、`cancel_before_confirmation` も同時検出。
2. **矛盾率の算出**
   - sample-001: コミットメント3件中2件が矛盾（率0.67）。
   - sample-002: 矛盾なし、正常ストーリー。
   - バッチ集計では 5件中2件が矛盾で矛盾率0.40。
3. **ルール拡張効果**
   - `requires_confirmation` フラグ導入により、REVISE後直ちにCANCELした場合の矛盾が明示化。
   - 将来的には期限超過判定など時間軸ルールを追加予定。
4. **矛盾タイプ別の修正提案**
   - `CONTRADICTION_SUGGESTIONS` を追加し、各矛盾に再発防止アクション（例: オーナー合意を得てからCANCEL）を付記。
   - `meeting-sample-003` を作成し、`cancel_without_assignment`/`duplicate_cancel`/`cancel_before_confirmation`/`unauthorized_cancel` を網羅的に確認。矛盾率は0.62、提案文付きレポートを `runs/20250917-c2-proto-v2/` に出力。

## 次に試すべきこと
- 実データ（AMI/ICSI）のアクションアイテムアノテーションへの適用テスト。
- `cancel_before_confirmation` の正例・負例を増やすサンプル作成。
- 提案文の効果検証（関係者ヒアリングやテンプレ文改善）と、矛盾タイプごとの修正ワークフローを設計。

更新日: 2025-09-17

## 詳細報告（2025-09-17）

### 背景と関連研究
会議理解の研究では、アクションアイテム抽出や要約に焦点を当てた研究が多く、Golia & Kalita (2023) の階層型要約や Liu et al. (2023) のコンテキスト正則化などが代表例である。一方、コミットメントのライフサイクル全体（ASSIGN→CONFIRM→REVISE→CANCEL）を追跡し、矛盾を構造的に扱う公開手法は見当たらない。矛盾検出は LLM の自己矛盾分析（Wen et al., 2024）などが進むが、会議内の参加者間コミットメントを対象としたものは未整備である。これらのギャップを埋めるべく、C2-Graph ではコミットメント単位の状態遷移と矛盾検出を結び付け、さらに矛盾発生時の説明や提案までを内包する最小構成を目指している。

### 研究方針とロードマップ
2025年9月17日時点のキックオフメモでは、Detect→Frame→Design→Run→Analyze→Decide の9フェーズを短期イテレーションで回す計画を立てた。14日間のロードマップでは、はじめの3日で文献調査とギャップ分析を行い、その後データ整備とベースライン構築、試作実行、課題整理へと進む。成功指標として Action-Item F1 / Contradiction F1 / Who-What-When QA を設定し、8週間以内に小規模データで差分を明示することを MVR ゴールと定めている。

### これまでの作業経緯
Detect フェーズでは関連論文を収集し、コミットメント遷移を扱う先行研究が不足していること、矛盾説明を付与する設計が重要であることを整理した。その後、`scripts/prototype/c2_graph_baseline.py` を用いて最小の矛盾検出器を試作し、サンプル会議データで `unauthorized_cancel` などの典型ケースを検出することに成功。バッチ集計スクリプトやコミットメッセージテンプレートを整備し、研究ログが一貫して蓄積できる状態を構築した。

### 今回の実施内容
今回のサイクルでは「矛盾検出結果に即応可能な提案を添付する」ことを目標に、矛盾タイプ別のアクション推薦 (`CONTRADICTION_SUGGESTIONS`) を実装した。併せて `meeting-sample-003` を新規作成し、無割り当てキャンセル・権限外キャンセル・重複キャンセル・確認前キャンセルを網羅するよう設計。レポート生成ロジックでは矛盾行ごとに提案文を付与し、バッチレポートでも同形式で閲覧できるよう整形した。

### 結果と評価
3件のサンプル会議を解析した結果、コミットメント計8件中5件が矛盾に該当し、矛盾率0.62、タイプ内訳（cancel_before_confirmation:2, cancel_without_assignment:1, duplicate_cancel:1, unauthorized_cancel:3）を提案文付きで可視化できた。`meeting-sample-003` では全矛盾パターンを期待通りに検出し、矛盾率1.00で正規化された値を得られた。これにより、矛盾発生時に「誰が何をすべきか」をレポート上で即座に共有できることを確認した。

### 考察
提案文を自動生成することで、検出結果をレビューするだけで次アクションを合意できる可能性が高まった。一方、提案文はテンプレートベースであり、チーム固有の運用や役割分担に合致する保証はない。さらに、現在の矛盾検出ルールは期限超過や遷移の多段チェーンを扱っておらず、実データにおける複雑なケースをカバーしきれていない。提案文が本当に運用改善につながるかは、実会議データでの検証とユーザーフィードバックが不可欠である。

### 今後の予定
次サイクルでは AMI / ICSI のアクションアイテムアノテーションに C2-Graph を適用し、矛盾率や提案文の妥当性を評価する。また、関係者ヒアリングを通じて提案文の表現改善と、矛盾タイプ別の是正ワークフロー設計（例: オーナー合意の再確認、自動リマインド）を進める。加えて、期限超過など時間軸ルールやオーナー交代の再確認手続きを実装し、矛盾検出のカバレッジを拡張する計画である。これらの成果を踏まえ、14日後の判断ポイントで継続／ピボット／撤退を決定する。
